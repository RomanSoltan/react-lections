# Заняття 13 - HTTP-запити з Redux Toolkit

- Асинхронні операції
- Форма стану слайса: loading, error, data
- Оголошення операції `fetchTasks` через `createAsyncThunk`
  - mockapi
  - Діспатч операції у компоненті при монтуванні
  - Екшени операціії: pending, fulfilled, rejected
  - Обробка результату операцій у слайсі (`extraReducers`)
  - Обробка запиту, що завершився з помилкою (`thunkAPI.rejectWithValue`)
- Операціі `addTask` та `deleteTask`
  - Діспатч операцій у компонентах
  - Обробка результату операцій у слайсі

# Висновки

Сьогодні ми подивились на операції, які виконують велику роль
в redux, тому що вони дозволяють робити асинхронні запити і
контролювати це все у slice. Вони автоматично нам генерують три
типи статусів:

- pending
- fulfilled
- rejected

І ми можемо це відслідковувати, напр. можна викидувати fulfilled
звичайними return або rejected, якщо у нас виконується rejectWithValue
операції.

Thunk оголосити досить просто:

1. Потрібно викликати createAsyncThunk() з бібліотеки @reduxjs/toolkit
2. Передати назву цієї санки, його тип
3. А також асинхронну колбек функцію, у якій бажано використовувати try/catch

- в блоці try описуємо сам запит на сервер і викидуємо дані звідси, якщо успішно
- в блоці catch ми відловлюємо помилку, з допомогою thunkAPI

```
export const deleteTodo = createAsyncThunk(
  // назва санки
  "todos/deleteTodo",
  async (id, thunkAPI) => {
    try {
      await axios.delete(`/tasks/${id}`);
      return id;
    } catch (error) {
      return thunkAPI.rejectWithValue(error.message);
    }
  }
);
```

Коли ми це все викинули, то ми маємо це все відловити і для цього
у нас є slice. В слайсі зявляється нова штука, яка називається
extraReducers. Її значенням виступає функція builder колбек (може
мати довільну назву). І цей builder будує собі addCase(), яких може
бути безліч. Кожен кейс описується через саму функцію, що хочемо ми
зробити, напр, якщо я хочу відловити видалення або додавання, або
редагування, то я має написати цю санку, потім дати значення статуса,
тобто pending, fulfilled або rejected, і описати функцію, що
трапиться з нашим стейтом. Якщо ми це реалізуємо, описали слайс
описали operations, то тоді ми ідемо по компонентам і там де треба
ми викликаємо наші санки, а також запит за початковими даними, нам
треба якось їх відмалювати. fetchData має бути. Для цього
використовується dispatch(), в якому передається наша санка.
Викликає все це діло useEffect
